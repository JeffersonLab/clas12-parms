##########################
# HOLDOFF
##########################

# 25 ns holdoff:
#TI_HOLDOFF 1 50 1

# 21/22 ns holdoff:
#TI_HOLDOFF 1 45 1

# 20 ns holdoff:
#TI_HOLDOFF 1 40 1

# 15 ns holdoff:
#TI_HOLDOFF 1 30 1

# 10 ns holdoff:
#TI_HOLDOFF 1 20 1


##########################
# GTP
##########################
GTP_CRATE all

GTP_CLUSTER_PULSE_COIN      4    4

# SEED thrershold in MeV (0-8191)
GTP_CLUSTER_PULSE_THRESHOLD 50

GTP_CRATE end

##########################
# HPS 11 Crate
##########################

### TI
TI_CRATE hps11

TI_FIBER_DELAY_OFFSET 0x80 0xcf
TI_BUFFER_LEVEL 5
TI_BLOCK_LEVEL  10

# PRESCALE-FACTOR = 2^N

# SINGLES-0:
TI_INPUT_PRESCALE 1  13

# SINGLES-1:
TI_INPUT_PRESCALE 2  11

# PAIRS-0:
TI_INPUT_PRESCALE 3  7

# PAIRS-1:
TI_INPUT_PRESCALE 4  0

# COSMIC/LED:
TI_INPUT_PRESCALE 5  0

# PULSER:
TI_INPUT_PRESCALE 6  0

TI_CRATE end


### SSP
SSP_CRATE hps11

SSP_ALLSLOTS
SSP_W_WIDTH   50
SSP_W_OFFSET  757

# COSMIC:
#SSP_W_WIDTH   100
#SSP_W_OFFSET  799

SSP_HPS_PULSER 100       # pulser period (s)

# ecal triggers:
# HPS SINGLES 0  -> TI TS1
SSP_HPS_SET_IO_SRC		7	20	#ENABLED
#SSP_HPS_SET_IO_SRC		7	0	#DISABLED

#HPS SINGLES 1   -> TI TS2
SSP_HPS_SET_IO_SRC		8	21	#ENABLED
#SSP_HPS_SET_IO_SRC		8	0	#DISABLED

#HPS PAIRS 0     -> TI TS3
SSP_HPS_SET_IO_SRC		9	22	#ENABLED
#SSP_HPS_SET_IO_SRC		9	0	#DISABLED

#HPS PAIRS 1     -> TI TS4
SSP_HPS_SET_IO_SRC		10	23	#ENABLED
#SSP_HPS_SET_IO_SRC		10	0	#DISABLED

# HPS COSMIC/LED -> TI TS5
#SSP_HPS_SET_IO_SRC		11	24	#ENABLED-LED
#SSP_HPS_SET_IO_SRC		11	25	#ENABLED-COSMIC
SSP_HPS_SET_IO_SRC		11	0	#DISABLED

# PULSER         -> TI TS6
SSP_HPS_SET_IO_SRC		12	18	#ENABLED
#SSP_HPS_SET_IO_SRC		12	0	#DISABLED


# coinc time 10=40 ns
SSP_HPS_COSMIC_TIMECOINCIDENCE  10

# cosmic B0 and B1 (136<<8) + led trigger (254<<0)
SSP_HPS_COSMIC_PATTERNCOINCIDENCE   35070

SSP_HPS_LATENCY 475

# Singles 0 trigger
SSP_HPS_SINGLES_EMIN  0  60  1
SSP_HPS_SINGLES_EMAX  0  2500 1
SSP_HPS_SINGLES_NMIN  0  3    1

# Singles 1 trigger
SSP_HPS_SINGLES_EMIN  1  400  1
SSP_HPS_SINGLES_EMAX  1  1100 1
SSP_HPS_SINGLES_NMIN  1  3    1

# Pairs 0 trigger
SSP_HPS_PAIRS_TIMECOINCIDENCE  0  4
SSP_HPS_PAIRS_EMIN             0  55
SSP_HPS_PAIRS_EMAX             0  1100
SSP_HPS_PAIRS_NMIN             0  3
SSP_HPS_PAIRS_SUMMAX_MIN       0  2000 120 1
SSP_HPS_PAIRS_DIFFMAX          0  1000     1
SSP_HPS_PAIRS_COPLANARITY      0  180      0
SSP_HPS_PAIRS_ENERGYDIST       0  5.5  100 0

# Pairs 1 trigger
SSP_HPS_PAIRS_TIMECOINCIDENCE  1  4
SSP_HPS_PAIRS_EMIN             1  60
SSP_HPS_PAIRS_EMAX             1  630
SSP_HPS_PAIRS_NMIN             1  2
SSP_HPS_PAIRS_SUMMAX_MIN       1  860 200  1
SSP_HPS_PAIRS_DIFFMAX          1  540      1
SSP_HPS_PAIRS_COPLANARITY      1  30       1
SSP_HPS_PAIRS_ENERGYDIST       1  5.5  600 1

SSP_CRATE end


### FADC: RF SIGNALS, HPS11, SLOT 13, CHANNELS 0/1
FADC250_CRATE hps11

FADC250_SLOT all
FADC250_DAC  3300
FADC250_W_OFFSET 3012
FADC250_W_WIDTH 400

FADC250_MODE      1
FADC250_NSB       12
FADC250_NSA       240
FADC250_NPEAK     1

#       channel:  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15
FADC250_ADC_MASK  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
FADC250_TRG_MASK  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1

#Set RF clock threshold
FADC250_TET 800

FADC250_SLOT 13
FADC250_ALLCH_PED 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0

FADC250_CRATE end


##########################
# HPS 12 Crate
##########################

### TI
TI_CRATE hps12
TI_FIBER_DELAY_OFFSET 0x80 0xc9
TI_CRATE end


##########################
# HPS 1 Crate
##########################

### TI
TI_CRATE hps1
TI_FIBER_DELAY_OFFSET 0x80 0xc9
TI_CRATE end



# ECAL PEDESTALS:

# include trigger/HPS/small/fadc250/peds/EcalPeds.trg

FADC250_CRATE  hps1
FADC250_SLOT  3
FADC250_ALLCH_PED  125.024  58.718 100.042  97.710 115.843 123.502 100.551 132.420 139.344 140.374 136.377 140.504  94.556 130.142 106.532 119.343
FADC250_SLOT  4
FADC250_ALLCH_PED  103.338  97.690  83.176  90.340 117.744  77.038 157.133  66.296 101.950  95.206  62.086 102.795  63.547 130.168  90.647 121.198
FADC250_SLOT  5
FADC250_ALLCH_PED   87.884 143.927  97.160 118.695  97.298 126.732 111.583 132.975  88.143 144.381 112.686 124.652 100.505 114.143  89.043 121.612
FADC250_SLOT  6
FADC250_ALLCH_PED  129.281 100.889 165.378 161.294 155.907 148.351 126.988 106.448 129.324 140.479  84.449 126.810 136.309 113.401 100.796 122.745
FADC250_SLOT  7
FADC250_ALLCH_PED  124.383 139.957 130.266 127.402 125.812 107.653 143.912 147.123 112.725 108.286 125.144 123.596 103.067 113.900 115.982 107.368
FADC250_SLOT  8
FADC250_ALLCH_PED  141.472 133.965  98.504 123.930 127.547 108.498 123.974 118.135 113.754  93.221 136.980 136.403 154.927 115.014 127.046  50.880
FADC250_SLOT  9
FADC250_ALLCH_PED  123.602 139.412 107.206 112.835 127.664 119.001 130.374 137.422 107.130 125.174 120.345  83.199 125.011 103.995  95.021 135.512
FADC250_SLOT  14
FADC250_ALLCH_PED   94.172 100.029 128.722 101.023 114.456 112.576 168.684 140.814 126.874  91.858 122.416 112.400 130.161 120.819 112.367 110.878
FADC250_SLOT  15
FADC250_ALLCH_PED  104.518 147.919 105.198 185.517 141.167 149.785 143.976 149.559 112.047 163.023 103.928 132.434 109.207 129.711 142.021 118.969
FADC250_SLOT  16
FADC250_ALLCH_PED  112.132 144.384 118.399 137.870 157.418  83.011 112.966 111.341  80.261 109.461  86.885 132.711 128.078 107.477 105.210 116.460
FADC250_SLOT  17
FADC250_ALLCH_PED   94.530  94.177 127.192 119.964 140.830  93.192 121.198 121.378 118.216  86.885 133.996  99.763  92.773  97.391  71.059 105.513
FADC250_SLOT  18
FADC250_ALLCH_PED  108.422 124.070 137.027 105.135 135.844 128.068 129.393 118.680  77.920 105.016 102.315 120.505 162.853 141.855 142.251 120.297
FADC250_SLOT  19
FADC250_ALLCH_PED  109.953 129.608 128.498  54.631  91.997 145.386 127.610 135.196 125.938 121.915 141.880 123.479 132.703 106.867 121.693 133.488
FADC250_SLOT  20
FADC250_ALLCH_PED  111.888  93.265 108.095 129.556  83.598 117.972 106.506  87.508 126.604  84.962 104.924  99.507 109.845   0.000   0.000   0.000
FADC250_CRATE end
FADC250_CRATE  hps2
FADC250_SLOT  3
FADC250_ALLCH_PED  138.879 111.262  92.345 133.090 123.493  88.304 158.318 101.487 132.958 139.586 113.309 146.363 137.733 119.201 134.441 155.442
FADC250_SLOT  4
FADC250_ALLCH_PED  138.135 114.932 134.543 117.174 107.172 172.312 161.865 137.235 148.163 124.281 144.889 129.572 148.717 138.605 146.792 122.904
FADC250_SLOT  5
FADC250_ALLCH_PED   97.653  80.993  99.326 125.266 127.932 115.048 110.877 140.482 127.274 129.862  99.309 143.243 126.160 105.559 116.843 119.638
FADC250_SLOT  6
FADC250_ALLCH_PED   95.510 113.312 120.265 110.928 144.607 118.656  89.015  90.087 121.033 164.120 119.488 132.025  92.967 153.059 105.521 125.261
FADC250_SLOT  7
FADC250_ALLCH_PED  178.009 110.851 109.189 126.665 137.690 148.923 131.249 114.925 149.432 134.008 117.471 111.574 119.469 138.198 124.909 145.352
FADC250_SLOT  8
FADC250_ALLCH_PED  114.746 126.344  92.051 100.132 108.842  85.678 122.747 133.499  86.750 151.527 111.237  80.280 105.568  93.072  80.576  95.044
FADC250_SLOT  9
FADC250_ALLCH_PED  123.182 183.008 160.876 155.435 123.208 105.161 115.012 117.501 112.059 173.295 145.595 118.209 134.585 137.817 138.305 163.854
FADC250_SLOT  14
FADC250_ALLCH_PED  151.013 149.615 115.289 100.912 124.799 140.340 125.347 112.905 157.280 149.932 118.773 141.771 104.421 149.078  91.129 127.719
FADC250_SLOT  15
FADC250_ALLCH_PED   94.697 128.788  93.125  87.598 108.851 123.899 118.483 121.526 109.392 113.861 121.844  85.239 101.726 117.957 159.800  79.382
FADC250_SLOT  16
FADC250_ALLCH_PED  107.641 113.340  95.939  94.705 106.154 123.546 107.969 102.455 123.774  99.207 151.473 119.358 115.839 141.046  90.462  98.801
FADC250_SLOT  17
FADC250_ALLCH_PED  116.085 129.314 114.040 105.134 112.566 123.821 114.819 110.716 127.121 116.939 116.267 117.665 115.932 107.701 161.965 120.717
FADC250_SLOT  18
FADC250_ALLCH_PED  142.073 128.909 116.864 142.971 140.963 141.690 143.298 105.995 103.220 110.629 139.610 183.857 140.655 117.327 129.924 156.582
FADC250_SLOT  19
FADC250_ALLCH_PED  118.001 137.980 144.842 101.777  96.170 142.916  90.116  86.908  96.485 119.470 111.011  99.770 128.862 142.807 100.379 144.580
FADC250_SLOT  20
FADC250_ALLCH_PED  114.648 112.809 124.837 114.183  94.330 113.433 114.635  75.154 115.057 115.907  90.676  88.425 128.203   0.000   0.000   0.000
FADC250_CRATE end

# include trigger/HPS/small/fadc250/peds/CalibPeds.trg

FADC250_CRATE hps1
FADC250_SLOT 20
FADC250_CH_PED 13  78.937
FADC250_CH_PED 14  99.759
FADC250_CH_PED 15 194.484
FADC250_CRATE end
FADC250_CRATE hps2
FADC250_SLOT 20
FADC250_CH_PED 13 118.765
FADC250_CH_PED 14 142.444
FADC250_CH_PED 15  93.138
FADC250_CRATE end


### FADC
FADC250_CRATE hps1

FADC250_SLOT all
FADC250_DAC  3300

FADC250_W_OFFSET 3012
FADC250_W_WIDTH   200

# COSMIC:
#FADC250_W_OFFSET 3180
#FADC250_W_WIDTH   400

FADC250_MODE      1
FADC250_NSB       20
FADC250_NSA       100
FADC250_NPEAK     1

#       channel:        0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15
FADC250_ADC_MASK        1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
FADC250_TRG_MASK        1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
FADC250_TET_IGNORE_MASK 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0

FADC250_TET 12

FADC250_SLOT  3
FADC250_ALLCH_GAIN    0.213   0.232   0.213   0.220   0.229   0.186   0.188   0.214   0.189   0.206   0.206   0.215   0.213   0.221   0.231   0.200
FADC250_SLOT  4
FADC250_ALLCH_GAIN    0.204   0.198   0.219   0.207   0.217   0.217   0.218   0.210   0.211   0.224   0.222   0.215   0.228   0.269   0.196   0.209
FADC250_SLOT  5
FADC250_ALLCH_GAIN    0.205   0.203   0.179   0.211   0.192   0.211   0.204   0.214   0.205   0.204   0.201   0.228   0.209   0.219   0.188   0.213
FADC250_SLOT  6
FADC250_ALLCH_GAIN    0.215   0.199   0.225   0.186   0.200   0.177   0.232   0.213   0.225   0.197   0.212   0.217   0.200   0.188   0.212   0.203
FADC250_SLOT  7
FADC250_ALLCH_GAIN    0.224   0.217   0.194   0.206   0.215   0.220   0.217   0.206   0.190   0.160   0.227   0.193   0.217   0.201   0.192   0.221
FADC250_SLOT  8
FADC250_ALLCH_GAIN    0.208   0.205   0.196   0.208   0.207   0.205   0.201   0.209   0.200   0.204   0.196   0.225   0.223   0.197   0.213   0.212
FADC250_SLOT  9
FADC250_ALLCH_GAIN    0.220   0.215   0.207   0.187   0.178   0.207   0.209   0.209   0.202   0.190   0.221   0.197   0.195   0.220   0.201   0.225
FADC250_SLOT  14
FADC250_ALLCH_GAIN    0.205   0.203   0.211   0.257   0.219   0.208   0.217   0.189   0.185   0.202   0.197   0.233   0.208   0.232   0.192   0.232
FADC250_SLOT  15
FADC250_ALLCH_GAIN    0.200   0.218   0.217   0.206   0.238   0.217   0.211   0.205   0.213   0.214   0.189   0.213   0.221   0.216   0.209   0.212
FADC250_SLOT  16
FADC250_ALLCH_GAIN    0.198   0.197   0.195   0.213   0.229   0.191   0.194   0.206   0.200   0.215   0.200   0.222   0.208   0.219   0.222   0.203
FADC250_SLOT  17
FADC250_ALLCH_GAIN    0.213   0.218   0.217   0.190   0.219   0.227   0.202   0.206   0.210   0.212   0.227   0.201   0.212   0.215   0.216   0.209
FADC250_SLOT  18
FADC250_ALLCH_GAIN    0.191   0.231   0.194   0.208   0.219   0.211   0.207   0.195   0.191   0.207   0.201   0.199   0.208   0.211   0.217   0.201
FADC250_SLOT  19
FADC250_ALLCH_GAIN    0.191   0.197   0.204   0.208   0.209   0.215   0.211   0.216   0.205   0.248   0.216   0.225   0.238   0.236   0.193   0.197
FADC250_SLOT  20
FADC250_ALLCH_GAIN    0.210   0.213   0.178   0.194   0.196   0.209   0.248   0.210   0.188   0.229   0.242   0.227   0.207   1.000   1.000   1.000

# Set LED system trigger threshold
FADC250_SLOT      20
FADC250_CH_TET    15   500

#       channel:        0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15
FADC250_TET_IGNORE_MASK 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0

FADC250_CRATE end

##########################
# HPS 2 Crate
##########################

### TI
TI_CRATE hps2
TI_FIBER_DELAY_OFFSET 0x80 0xc9
TI_CRATE end

### FADC
FADC250_CRATE hps2

FADC250_SLOT all
FADC250_DAC  3300

FADC250_W_OFFSET 3012
FADC250_W_WIDTH   200

# COSMIC:
#FADC250_W_OFFSET 3180
#FADC250_W_WIDTH   400

FADC250_MODE      1
FADC250_NSB       20
FADC250_NSA       100
FADC250_NPEAK     1

#       channel:        0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15
FADC250_ADC_MASK        1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
FADC250_TRG_MASK        1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
FADC250_TET_IGNORE_MASK 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0

FADC250_TET 12

FADC250_SLOT  3
FADC250_ALLCH_GAIN    0.290   0.224   0.217   0.284   0.246   0.227   0.262   0.220   0.244   0.214   0.220   0.191   0.208   0.214   0.226   0.214
FADC250_SLOT  4
FADC250_ALLCH_GAIN    0.202   0.206   0.232   0.239   0.209   0.234   0.203   0.196   0.202   0.221   0.219   0.240   0.209   0.230   0.210   0.193
FADC250_SLOT  5
FADC250_ALLCH_GAIN    0.208   0.200   0.194   0.203   0.197   0.200   0.208   0.209   0.203   0.218   0.200   0.202   0.199   0.213   0.213   0.190
FADC250_SLOT  6
FADC250_ALLCH_GAIN    0.194   0.182   0.195   0.184   0.188   0.210   0.218   0.237   0.213   0.211   0.203   0.185   0.221   0.206   0.212   0.202
FADC250_SLOT  7
FADC250_ALLCH_GAIN    0.200   0.218   0.214   0.180   0.217   0.201   0.227   0.221   0.221   0.236   0.217   0.209   0.228   0.213   0.207   0.229
FADC250_SLOT  8
FADC250_ALLCH_GAIN    0.201   0.194   0.297   0.202   0.211   0.238   0.189   0.204   0.203   0.223   0.219   0.194   0.211   0.202   0.194   0.209
FADC250_SLOT  9
FADC250_ALLCH_GAIN    0.194   0.200   0.199   0.204   0.221   0.180   0.204   0.217   0.213   0.207   0.186   0.182   0.201   0.205   0.202   0.215
FADC250_SLOT  14
FADC250_ALLCH_GAIN    0.215   0.209   0.196   0.206   0.189   0.209   0.196   0.237   0.208   0.214   0.151   0.211   0.183   0.207   0.223   0.239
FADC250_SLOT  15
FADC250_ALLCH_GAIN    0.212   0.208   0.215   0.207   0.215   0.191   0.191   0.202   0.192   0.220   0.190   0.188   0.212   0.190   0.205   0.198
FADC250_SLOT  16
FADC250_ALLCH_GAIN    0.224   0.219   0.185   0.220   0.215   0.191   0.200   0.222   0.214   0.226   0.229   0.237   0.220   0.225   0.205   0.209
FADC250_SLOT  17
FADC250_ALLCH_GAIN    0.189   0.188   0.186   0.209   0.190   0.190   0.221   0.193   0.212   0.211   0.197   0.204   0.233   0.191   0.193   0.189
FADC250_SLOT  18
FADC250_ALLCH_GAIN    0.204   0.213   0.218   0.212   0.199   0.197   0.219   0.190   0.200   0.220   0.208   0.211   0.210   0.202   0.228   0.268
FADC250_SLOT  19
FADC250_ALLCH_GAIN    0.202   0.251   0.194   0.197   0.243   0.217   0.214   0.208   0.227   0.202   0.204   0.198   0.201   0.219   0.215   0.199
FADC250_SLOT  20
FADC250_ALLCH_GAIN    0.241   0.216   0.219   0.199   0.204   0.206   0.212   0.209   0.213   0.222   0.212   0.221   0.226   1.000   1.000   1.000

# Set cosmic system trigger threshold
# 12bit -> 1V: 40 = ~10mV threshold
# relative to pedestal
FADC250_SLOT      20
FADC250_CH_TET    13   40
FADC250_CH_TET    14   40
#       channel:        0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15
FADC250_TET_IGNORE_MASK 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0



FADC250_CRATE end


# SVT stuff

# include dpm/dpm-default.trg

DPM_CRATE all
DPM_CONFIG_FILE /usr/clas12/release/0.2/slac_svt/svtdaq/daq/config/rce_config.xml
DPM_CRATE end

# include dpm/dpm-3sam-3rms.trg

DPM_CRATE all
DPM_THR_CONFIG_FILE /usr/clas12/release/0.2/slac_svt/svtdaq/daq/thresholds/20150421_4912_thresholds_3rms.xml
DPM_CRATE end

