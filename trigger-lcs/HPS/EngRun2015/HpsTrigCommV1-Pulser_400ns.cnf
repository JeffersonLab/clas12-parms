##########################
# GTP
##########################
GTP_CRATE all

GTP_CLUSTER_PULSE_COIN      3    3

# SEED thrershold in MeV (0-8191)
GTP_CLUSTER_PULSE_THRESHOLD 50

GTP_CRATE end

##########################
# HPS 11 Crate
##########################

### TI
TI_CRATE hps11

TI_FIBER_DELAY_OFFSET 0x80 0xcf
TI_BUFFER_LEVEL 5
TI_BLOCK_LEVEL  1

# PRESCALE-FACTOR = 2^N

# SINGLES-0:
TI_INPUT_PRESCALE 1  11

# SINGLES-1:
TI_INPUT_PRESCALE 2  10

# PAIRS-0:
TI_INPUT_PRESCALE 3  4

# PAIRS-1:
TI_INPUT_PRESCALE 4  0

# COSMIC/LED:
TI_INPUT_PRESCALE 5  0

# PULSER:
TI_INPUT_PRESCALE 6  0

TI_CRATE end


### SSP
SSP_CRATE hps11

SSP_ALLSLOTS
SSP_W_WIDTH   100
SSP_W_OFFSET  757

# COSMIC:
#SSP_W_WIDTH   100
#SSP_W_OFFSET  799

SSP_HPS_PULSER 5000       # pulser period (s)

# ecal triggers:
# HPS SINGLES 0  -> TI TS1
#SSP_HPS_SET_IO_SRC		7	20	#ENABLED
SSP_HPS_SET_IO_SRC		7	0	#DISABLED

#HPS SINGLES 1   -> TI TS2
#SSP_HPS_SET_IO_SRC		8	21	#ENABLED
SSP_HPS_SET_IO_SRC		8	0	#DISABLED

#HPS PAIRS 0     -> TI TS3
#SSP_HPS_SET_IO_SRC		9	22	#ENABLED
SSP_HPS_SET_IO_SRC		9	0	#DISABLED

#HPS PAIRS 1     -> TI TS4
#SSP_HPS_SET_IO_SRC		10	23	#ENABLED
SSP_HPS_SET_IO_SRC		10	0	#DISABLED

# HPS COSMIC/LED -> TI TS5
#SSP_HPS_SET_IO_SRC		11	24	#ENABLED-LED
#SSP_HPS_SET_IO_SRC		11	25	#ENABLED-COSMIC
SSP_HPS_SET_IO_SRC		11	0	#DISABLED

# PULSER         -> TI TS6
SSP_HPS_SET_IO_SRC		12	18	#ENABLED
#SSP_HPS_SET_IO_SRC		12	0	#DISABLED


# coinc time 10=40 ns
SSP_HPS_COSMIC_TIMECOINCIDENCE  10

# cosmic B0 and B1 (136<<8) + led trigger (254<<0)
SSP_HPS_COSMIC_PATTERNCOINCIDENCE   35070

SSP_HPS_LATENCY 475

# Singles 0 trigger
SSP_HPS_SINGLES_EMIN  0  60  1
SSP_HPS_SINGLES_EMAX  0  2500 1
SSP_HPS_SINGLES_NMIN  0  3    1

# Singles 0 trigger
SSP_HPS_SINGLES_EMIN  1  400  1
SSP_HPS_SINGLES_EMAX  1  1000 1
SSP_HPS_SINGLES_NMIN  1  3    1

# Pairs 0 trigger
SSP_HPS_PAIRS_TIMECOINCIDENCE  0  4
SSP_HPS_PAIRS_EMIN             0  55
SSP_HPS_PAIRS_EMAX             0  1100
SSP_HPS_PAIRS_NMIN             0  3
SSP_HPS_PAIRS_SUMMAX_MIN       0  2000 120 1
SSP_HPS_PAIRS_DIFFMAX          0  1000     1
SSP_HPS_PAIRS_COPLANARITY      0  180      0
SSP_HPS_PAIRS_ENERGYDIST       0  5.5  100 0

# Pairs 1 trigger
SSP_HPS_PAIRS_TIMECOINCIDENCE  1  4
SSP_HPS_PAIRS_EMIN             1  60
SSP_HPS_PAIRS_EMAX             1  650
SSP_HPS_PAIRS_NMIN             1  3
SSP_HPS_PAIRS_SUMMAX_MIN       1  815 150 1
SSP_HPS_PAIRS_DIFFMAX          1  650      1
SSP_HPS_PAIRS_COPLANARITY      1  50       1
SSP_HPS_PAIRS_ENERGYDIST       1  5.5  400 1

SSP_CRATE end


### FADC: RF SIGNALS, HPS11, SLOT 13, CHANNELS 0/1
FADC250_CRATE hps11

FADC250_SLOT all
FADC250_DAC  3300
FADC250_W_OFFSET 3012
FADC250_W_WIDTH 400

FADC250_MODE      1
FADC250_NSB       12
FADC250_NSA       240
FADC250_NPEAK     1

#       channel:  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15
FADC250_ADC_MASK  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
FADC250_TRG_MASK  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1

#Set RF clock threshold
FADC250_TET 800

FADC250_SLOT 13
FADC250_ALLCH_PED 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0

FADC250_CRATE end


##########################
# HPS 12 Crate
##########################

### TI
TI_CRATE hps12
TI_FIBER_DELAY_OFFSET 0x80 0xc9
TI_CRATE end


##########################
# HPS 1 Crate
##########################

### TI
TI_CRATE hps1
TI_FIBER_DELAY_OFFSET 0x80 0xc9
TI_CRATE end


# ECAL PEDESTALS:

# include trigger/HPS/small/fadc250/peds/EcalPeds.trg

FADC250_CRATE  hps1
FADC250_SLOT  3
FADC250_ALLCH_PED  125.015  58.719  99.804  97.417 115.043 122.926  99.931 132.136 138.141 140.871 135.496 140.390  94.455 129.938 105.243 118.523
FADC250_SLOT  4
FADC250_ALLCH_PED  103.031  97.080  83.006  89.805 117.071  76.948 156.413  65.938 101.916  94.730  61.477 102.597  63.004 129.758  89.905 120.733
FADC250_SLOT  5
FADC250_ALLCH_PED   87.686 143.466  96.258 117.865  96.594 126.243 111.042 132.396  88.097 144.354 112.122 124.362 100.538 113.655  88.267 120.976
FADC250_SLOT  6
FADC250_ALLCH_PED  128.509 100.411 165.460 160.605 155.578 148.108 126.636 106.122 128.877 139.682  83.895 125.863 136.366 112.239 100.150 121.752
FADC250_SLOT  7
FADC250_ALLCH_PED  124.069 139.226 130.225 127.042 125.247 107.574 143.608 146.980 112.133 107.737 124.737 122.796 102.339 113.505 115.747 107.068
FADC250_SLOT  8
FADC250_ALLCH_PED  141.385 134.070  97.845 123.686 126.991 107.966 123.635 117.987 113.264  92.807 136.522 136.494 154.946 114.506 126.932  50.083
FADC250_SLOT  9
FADC250_ALLCH_PED  123.507 138.952 106.328 112.518 127.867 119.206 130.510 137.194 107.036 125.429 120.212  83.266 124.658 103.545  95.837 135.895
FADC250_SLOT  14
FADC250_ALLCH_PED   93.517  99.937 128.647 101.410 114.656 112.309 168.483 140.179 127.580  92.063 122.843 111.823 131.240 121.300 112.586 110.784
FADC250_SLOT  15
FADC250_ALLCH_PED  107.141 148.809 105.308 185.736 143.192 150.280 144.300 149.558 114.658 163.573 104.060 132.288 110.453 130.042 141.657 118.693
FADC250_SLOT  16
FADC250_ALLCH_PED  113.185 144.866 118.116 137.570 157.508  82.850 112.306 110.853  79.808 108.698  86.492 132.069 128.142 107.147 104.575 115.894
FADC250_SLOT  17
FADC250_ALLCH_PED   94.228  93.656 126.735 119.485 140.779  92.600 121.018 120.979 118.111  86.348 133.645  99.908  91.637  96.717  70.965 104.949
FADC250_SLOT  18
FADC250_ALLCH_PED  107.511 123.941 137.082 105.016 135.542 127.895 129.244 117.590  77.482 105.028 102.048 119.735 162.567 140.961 141.804 120.080
FADC250_SLOT  19
FADC250_ALLCH_PED  109.916 129.369 128.761  54.027  91.938 144.608 127.248 135.138 125.536 121.072 141.386 122.754 132.684 106.453 121.468 133.426
FADC250_SLOT  20
FADC250_ALLCH_PED  111.676  93.198 107.977 128.967  83.067 117.961 105.606  87.091 126.106  84.566 104.208  99.031 109.772   0.000   0.000   0.000
FADC250_CRATE end
FADC250_CRATE  hps2
FADC250_SLOT  3
FADC250_ALLCH_PED  139.230 111.248  91.603 132.962 123.037  87.389 158.509 100.817 132.993 140.052 113.146 146.294 138.081 118.816 133.411 154.852
FADC250_SLOT  4
FADC250_ALLCH_PED  138.030 114.388 134.378 116.161 106.884 172.102 161.856 136.940 147.562 124.215 144.259 129.410 148.590 138.209 146.805 122.381
FADC250_SLOT  5
FADC250_ALLCH_PED   97.755  80.913  98.557 125.063 128.058 114.900 110.941 140.899 127.154 130.113  98.634 143.038 126.099 105.359 117.122 119.175
FADC250_SLOT  6
FADC250_ALLCH_PED   95.250 113.336 120.517 110.573 144.537 118.862  89.085  89.459 120.643 164.026 119.144 131.265  92.385 153.104 105.276 124.683
FADC250_SLOT  7
FADC250_ALLCH_PED  177.914 110.443 109.334 126.589 137.667 149.024 131.489 114.853 149.047 133.824 117.132 111.484 119.126 137.979 124.915 145.199
FADC250_SLOT  8
FADC250_ALLCH_PED  114.938 126.024  91.938  99.729 108.280  86.033 122.405 133.405  86.281 151.772 111.393  80.393 105.333  93.135  80.135  94.904
FADC250_SLOT  9
FADC250_ALLCH_PED  122.824 182.804 160.616 155.232 122.650 105.165 114.578 117.562 111.369 173.697 145.295 118.052 134.256 137.778 139.308 164.511
FADC250_SLOT  14
FADC250_ALLCH_PED  151.018 149.266 114.894 102.361 125.278 140.697 125.185 113.039 157.682 149.751 119.045 141.136 106.657 150.005  90.995 127.395
FADC250_SLOT  15
FADC250_ALLCH_PED   97.657 129.474  93.219  87.267 112.265 124.769 118.801 121.123 112.688 113.895 122.438  85.134 102.577 118.689 160.189  78.684
FADC250_SLOT  16
FADC250_ALLCH_PED  107.956 113.166  95.254  94.260 106.513 123.185 107.826 102.640 123.290  98.836 151.614 118.853 115.762 140.890  90.540  98.323
FADC250_SLOT  17
FADC250_ALLCH_PED  115.974 128.938 113.503 105.228 112.390 123.548 114.972 110.568 126.641 116.984 116.737 117.591 115.668 106.890 161.545 120.652
FADC250_SLOT  18
FADC250_ALLCH_PED  141.667 129.066 116.595 143.010 140.278 141.067 143.057 105.779 102.507 110.688 139.440 183.559 140.505 116.952 129.359 156.469
FADC250_SLOT  19
FADC250_ALLCH_PED  117.644 137.809 144.553 101.313  95.737 142.972  89.943  86.929  96.265 119.614 110.418  99.399 128.614 142.940  99.927 144.172
FADC250_SLOT  20
FADC250_ALLCH_PED  114.404 113.105 124.769 113.886  94.166 113.077 114.140  74.193 114.981 115.897  90.611  88.333 127.724   0.000   0.000   0.000
FADC250_CRATE end

# include trigger/HPS/small/fadc250/peds/CalibPeds.trg

FADC250_CRATE hps1
FADC250_SLOT 20
FADC250_CH_PED 13  78.937
FADC250_CH_PED 14  99.759
FADC250_CH_PED 15 194.484
FADC250_CRATE end
FADC250_CRATE hps2
FADC250_SLOT 20
FADC250_CH_PED 13 118.765
FADC250_CH_PED 14 142.444
FADC250_CH_PED 15  93.138
FADC250_CRATE end


### FADC
FADC250_CRATE hps1

FADC250_SLOT all
FADC250_DAC  3300

FADC250_W_OFFSET 3012
FADC250_W_WIDTH   400

# COSMIC:
#FADC250_W_OFFSET 3180
#FADC250_W_WIDTH   400

FADC250_MODE      1
FADC250_NSB       20
FADC250_NSA       100
FADC250_NPEAK     1

#       channel:        0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15
FADC250_ADC_MASK        1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
FADC250_TRG_MASK        1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
FADC250_TET_IGNORE_MASK 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0

FADC250_TET 12

FADC250_SLOT  3
FADC250_ALLCH_GAIN    0.213   0.232   0.213   0.220   0.229   0.186   0.188   0.214   0.189   0.206   0.206   0.215   0.213   0.221   0.231   0.200
FADC250_SLOT  4
FADC250_ALLCH_GAIN    0.204   0.198   0.219   0.207   0.217   0.217   0.218   0.210   0.211   0.224   0.222   0.215   0.228   0.269   0.196   0.209
FADC250_SLOT  5
FADC250_ALLCH_GAIN    0.205   0.203   0.179   0.211   0.192   0.211   0.204   0.214   0.205   0.204   0.201   0.228   0.209   0.219   0.188   0.213
FADC250_SLOT  6
FADC250_ALLCH_GAIN    0.215   0.199   0.225   0.186   0.200   0.177   0.232   0.213   0.225   0.197   0.212   0.217   0.200   0.188   0.212   0.203
FADC250_SLOT  7
FADC250_ALLCH_GAIN    0.224   0.217   0.194   0.206   0.215   0.220   0.217   0.206   0.190   0.160   0.227   0.193   0.217   0.201   0.192   0.221
FADC250_SLOT  8
FADC250_ALLCH_GAIN    0.208   0.205   0.196   0.208   0.207   0.205   0.201   0.209   0.200   0.204   0.196   0.225   0.223   0.197   0.213   0.212
FADC250_SLOT  9
FADC250_ALLCH_GAIN    0.220   0.215   0.207   0.187   0.178   0.207   0.209   0.209   0.202   0.190   0.221   0.197   0.195   0.220   0.201   0.225
FADC250_SLOT  14
FADC250_ALLCH_GAIN    0.205   0.203   0.211   0.257   0.219   0.208   0.217   0.189   0.185   0.202   0.197   0.233   0.208   0.232   0.192   0.232
FADC250_SLOT  15
FADC250_ALLCH_GAIN    0.200   0.218   0.217   0.206   0.238   0.217   0.211   0.205   0.213   0.214   0.189   0.213   0.221   0.216   0.209   0.212
FADC250_SLOT  16
FADC250_ALLCH_GAIN    0.198   0.197   0.195   0.213   0.229   0.191   0.194   0.206   0.200   0.215   0.200   0.222   0.208   0.219   0.222   0.203
FADC250_SLOT  17
FADC250_ALLCH_GAIN    0.213   0.218   0.217   0.190   0.219   0.227   0.202   0.206   0.210   0.212   0.227   0.201   0.212   0.215   0.216   0.209
FADC250_SLOT  18
FADC250_ALLCH_GAIN    0.191   0.231   0.194   0.208   0.219   0.211   0.207   0.195   0.191   0.207   0.201   0.199   0.208   0.211   0.217   0.201
FADC250_SLOT  19
FADC250_ALLCH_GAIN    0.191   0.197   0.204   0.208   0.209   0.215   0.211   0.216   0.205   0.248   0.216   0.225   0.238   0.236   0.193   0.197
FADC250_SLOT  20
FADC250_ALLCH_GAIN    0.210   0.213   0.178   0.194   0.196   0.209   0.248   0.210   0.188   0.229   0.242   0.227   0.207   1.000   1.000   1.000

# Set LED system trigger threshold
FADC250_SLOT      20
FADC250_CH_TET    15   500

#       channel:        0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15
FADC250_TET_IGNORE_MASK 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0



FADC250_CRATE end

##########################
# HPS 2 Crate
##########################

### TI
TI_CRATE hps2
TI_FIBER_DELAY_OFFSET 0x80 0xc9
TI_CRATE end

### FADC
FADC250_CRATE hps2

FADC250_SLOT all
FADC250_DAC  3300

FADC250_W_OFFSET 3012
FADC250_W_WIDTH   400

# COSMIC:
#FADC250_W_OFFSET 3180
#FADC250_W_WIDTH   400

FADC250_MODE      1
FADC250_NSB       20
FADC250_NSA       100
FADC250_NPEAK     1

#       channel:        0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15
FADC250_ADC_MASK        1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
FADC250_TRG_MASK        1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
FADC250_TET_IGNORE_MASK 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0

FADC250_TET 12

FADC250_SLOT  3
FADC250_ALLCH_GAIN    0.290   0.224   0.217   0.284   0.246   0.227   0.262   0.220   0.244   0.214   0.220   0.191   0.208   0.214   0.226   0.214
FADC250_SLOT  4
FADC250_ALLCH_GAIN    0.202   0.206   0.232   0.239   0.209   0.234   0.203   0.196   0.202   0.221   0.219   0.240   0.209   0.230   0.210   0.193
FADC250_SLOT  5
FADC250_ALLCH_GAIN    0.208   0.200   0.194   0.203   0.197   0.200   0.208   0.209   0.203   0.218   0.200   0.202   0.199   0.213   0.213   0.190
FADC250_SLOT  6
FADC250_ALLCH_GAIN    0.194   0.182   0.195   0.184   0.188   0.210   0.218   0.237   0.213   0.211   0.203   0.185   0.221   0.206   0.212   0.202
FADC250_SLOT  7
FADC250_ALLCH_GAIN    0.200   0.218   0.214   0.180   0.217   0.201   0.227   0.221   0.221   0.236   0.217   0.209   0.228   0.213   0.207   0.229
FADC250_SLOT  8
FADC250_ALLCH_GAIN    0.201   0.194   0.297   0.202   0.211   0.238   0.189   0.204   0.203   0.223   0.219   0.194   0.211   0.202   0.194   0.209
FADC250_SLOT  9
FADC250_ALLCH_GAIN    0.194   0.200   0.199   0.204   0.221   0.180   0.204   0.217   0.213   0.207   0.186   0.182   0.201   0.205   0.202   0.215
FADC250_SLOT  14
FADC250_ALLCH_GAIN    0.215   0.209   0.196   0.206   0.189   0.209   0.196   0.237   0.208   0.214   0.151   0.211   0.183   0.207   0.223   0.239
FADC250_SLOT  15
FADC250_ALLCH_GAIN    0.212   0.208   0.215   0.207   0.215   0.191   0.191   0.202   0.192   0.220   0.190   0.188   0.212   0.190   0.205   0.198
FADC250_SLOT  16
FADC250_ALLCH_GAIN    0.224   0.219   0.185   0.220   0.215   0.191   0.200   0.222   0.214   0.226   0.229   0.237   0.220   0.225   0.205   0.209
FADC250_SLOT  17
FADC250_ALLCH_GAIN    0.189   0.188   0.186   0.209   0.190   0.190   0.221   0.193   0.212   0.211   0.197   0.204   0.233   0.191   0.193   0.189
FADC250_SLOT  18
FADC250_ALLCH_GAIN    0.204   0.213   0.218   0.212   0.199   0.197   0.219   0.190   0.200   0.220   0.208   0.211   0.210   0.202   0.228   0.268
FADC250_SLOT  19
FADC250_ALLCH_GAIN    0.202   0.251   0.194   0.197   0.243   0.217   0.214   0.208   0.227   0.202   0.204   0.198   0.201   0.219   0.215   0.199
FADC250_SLOT  20
FADC250_ALLCH_GAIN    0.241   0.216   0.219   0.199   0.204   0.206   0.212   0.209   0.213   0.222   0.212   0.221   0.226   1.000   1.000   1.000

# Set cosmic system trigger threshold
# 12bit -> 1V: 40 = ~10mV threshold
# relative to pedestal
FADC250_SLOT      20
FADC250_CH_TET    13   40
FADC250_CH_TET    14   40
#       channel:        0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15
FADC250_TET_IGNORE_MASK 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0





FADC250_CRATE end


# SVT stuff

# include dpm/dpm-default.trg

DPM_CRATE all
DPM_CONFIG_FILE /usr/clas12/release/0.2/slac_svt/svtdaq/daq/config/rce_config.xml
DPM_CRATE end

# include dpm/dpm-3sam-3rms.trg

DPM_CRATE all
DPM_THR_CONFIG_FILE /usr/clas12/release/0.2/slac_svt/svtdaq/daq/thresholds/20150421_4912_thresholds_3rms.xml
DPM_CRATE end
