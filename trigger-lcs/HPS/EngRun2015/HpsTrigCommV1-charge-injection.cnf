##########################
# GTP
##########################
GTP_CRATE all

GTP_CLUSTER_PULSE_COIN      3    3

# SEED thrershold in MeV (0-8191)
GTP_CLUSTER_PULSE_THRESHOLD 50

GTP_CRATE end

##########################
# HPS 11 Crate
##########################

### TI
TI_CRATE hps11

TI_FIBER_DELAY_OFFSET 0x80 0xcf
TI_BUFFER_LEVEL 5
TI_BLOCK_LEVEL  1

# PRESCALE-FACTOR = 2^N

# SINGLES-0:
TI_INPUT_PRESCALE 1  11

# SINGLES-1:
TI_INPUT_PRESCALE 2  10

# PAIRS-0:
TI_INPUT_PRESCALE 3  4

# PAIRS-1:
TI_INPUT_PRESCALE 4  0

# COSMIC/LED:
TI_INPUT_PRESCALE 5  0

# PULSER:
TI_INPUT_PRESCALE 6  0

TI_CRATE end


### SSP
SSP_CRATE hps11

SSP_ALLSLOTS
SSP_W_WIDTH   50
SSP_W_OFFSET  757

# COSMIC:
#SSP_W_WIDTH   100
#SSP_W_OFFSET  799

SSP_HPS_PULSER 50       # pulser period (s)

# ecal triggers:
# HPS SINGLES 0  -> TI TS1
#SSP_HPS_SET_IO_SRC		7	20	#ENABLED
SSP_HPS_SET_IO_SRC		7	0	#DISABLED

#HPS SINGLES 1   -> TI TS2
#SSP_HPS_SET_IO_SRC		8	21	#ENABLED
SSP_HPS_SET_IO_SRC		8	0	#DISABLED

#HPS PAIRS 0     -> TI TS3
#SSP_HPS_SET_IO_SRC		9	22	#ENABLED
SSP_HPS_SET_IO_SRC		9	0	#DISABLED

#HPS PAIRS 1     -> TI TS4
#SSP_HPS_SET_IO_SRC		10	23	#ENABLED
SSP_HPS_SET_IO_SRC		10	0	#DISABLED

# HPS COSMIC/LED -> TI TS5
#SSP_HPS_SET_IO_SRC		11	24	#ENABLED-LED
#SSP_HPS_SET_IO_SRC		11	25	#ENABLED-COSMIC
SSP_HPS_SET_IO_SRC		11	0	#DISABLED

# PULSER         -> TI TS6
SSP_HPS_SET_IO_SRC		12	18	#ENABLED
#SSP_HPS_SET_IO_SRC		12	0	#DISABLED


# coinc time 10=40 ns
SSP_HPS_COSMIC_TIMECOINCIDENCE  10

# cosmic B0 and B1 (136<<8) + led trigger (254<<0)
SSP_HPS_COSMIC_PATTERNCOINCIDENCE   35070

SSP_HPS_LATENCY 475

# Singles 0 trigger
SSP_HPS_SINGLES_EMIN  0  60  1
SSP_HPS_SINGLES_EMAX  0  2500 1
SSP_HPS_SINGLES_NMIN  0  3    1

# Singles 0 trigger
SSP_HPS_SINGLES_EMIN  1  400  1
SSP_HPS_SINGLES_EMAX  1  1000 1
SSP_HPS_SINGLES_NMIN  1  3    1

# Pairs 0 trigger
SSP_HPS_PAIRS_TIMECOINCIDENCE  0  4
SSP_HPS_PAIRS_EMIN             0  55
SSP_HPS_PAIRS_EMAX             0  1100
SSP_HPS_PAIRS_NMIN             0  3
SSP_HPS_PAIRS_SUMMAX_MIN       0  2000 120 1
SSP_HPS_PAIRS_DIFFMAX          0  1000     1
SSP_HPS_PAIRS_COPLANARITY      0  180      0
SSP_HPS_PAIRS_ENERGYDIST       0  5.5  100 0

# Pairs 1 trigger
SSP_HPS_PAIRS_TIMECOINCIDENCE  1  4
SSP_HPS_PAIRS_EMIN             1  60
SSP_HPS_PAIRS_EMAX             1  650
SSP_HPS_PAIRS_NMIN             1  3
SSP_HPS_PAIRS_SUMMAX_MIN       1  815 150 1
SSP_HPS_PAIRS_DIFFMAX          1  650      1
SSP_HPS_PAIRS_COPLANARITY      1  50       1
SSP_HPS_PAIRS_ENERGYDIST       1  5.5  400 1

SSP_CRATE end


### FADC: RF SIGNALS, HPS11, SLOT 13, CHANNELS 0/1
FADC250_CRATE hps11

FADC250_SLOT all
FADC250_DAC  3300
FADC250_W_OFFSET 3012
FADC250_W_WIDTH 400

FADC250_MODE      1
FADC250_NSB       12
FADC250_NSA       240
FADC250_NPEAK     1

#       channel:  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15
FADC250_ADC_MASK  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
FADC250_TRG_MASK  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1

#Set RF clock threshold
FADC250_TET 800

FADC250_SLOT 13
FADC250_ALLCH_PED 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0

FADC250_CRATE end


##########################
# HPS 12 Crate
##########################

### TI
TI_CRATE hps12
TI_FIBER_DELAY_OFFSET 0x80 0xc9
TI_CRATE end


##########################
# HPS 1 Crate
##########################

### TI
TI_CRATE hps1
TI_FIBER_DELAY_OFFSET 0x80 0xc9
TI_CRATE end

### FADC
FADC250_CRATE hps1

FADC250_SLOT all
FADC250_DAC  3300

FADC250_W_OFFSET 3012
FADC250_W_WIDTH   200

# COSMIC:
#FADC250_W_OFFSET 3180
#FADC250_W_WIDTH   400

FADC250_MODE      1
FADC250_NSB       20
FADC250_NSA       100
FADC250_NPEAK     1

#       channel:        0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15
FADC250_ADC_MASK        1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
FADC250_TRG_MASK        1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
FADC250_TET_IGNORE_MASK 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0

FADC250_TET 12

FADC250_SLOT  3
FADC250_ALLCH_GAIN    0.213   0.232   0.213   0.220   0.229   0.186   0.188   0.214   0.189   0.206   0.206   0.215   0.213   0.221   0.231   0.200
FADC250_SLOT  4
FADC250_ALLCH_GAIN    0.204   0.198   0.219   0.207   0.217   0.217   0.218   0.210   0.211   0.224   0.222   0.215   0.228   0.269   0.196   0.209
FADC250_SLOT  5
FADC250_ALLCH_GAIN    0.205   0.203   0.179   0.211   0.192   0.211   0.204   0.214   0.205   0.204   0.201   0.228   0.209   0.219   0.188   0.213
FADC250_SLOT  6
FADC250_ALLCH_GAIN    0.215   0.199   0.225   0.186   0.200   0.177   0.232   0.213   0.225   0.197   0.212   0.217   0.200   0.188   0.212   0.203
FADC250_SLOT  7
FADC250_ALLCH_GAIN    0.224   0.217   0.194   0.206   0.215   0.220   0.217   0.206   0.190   0.160   0.227   0.193   0.217   0.201   0.192   0.221
FADC250_SLOT  8
FADC250_ALLCH_GAIN    0.208   0.205   0.196   0.208   0.207   0.205   0.201   0.209   0.200   0.204   0.196   0.225   0.223   0.197   0.213   0.212
FADC250_SLOT  9
FADC250_ALLCH_GAIN    0.220   0.215   0.207   0.187   0.178   0.207   0.209   0.209   0.202   0.190   0.221   0.197   0.195   0.220   0.201   0.225
FADC250_SLOT  14
FADC250_ALLCH_GAIN    0.205   0.203   0.211   0.257   0.219   0.208   0.217   0.189   0.185   0.202   0.197   0.233   0.208   0.232   0.192   0.232
FADC250_SLOT  15
FADC250_ALLCH_GAIN    0.200   0.218   0.217   0.206   0.238   0.217   0.211   0.205   0.213   0.214   0.189   0.213   0.221   0.216   0.209   0.212
FADC250_SLOT  16
FADC250_ALLCH_GAIN    0.198   0.197   0.195   0.213   0.229   0.191   0.194   0.206   0.200   0.215   0.200   0.222   0.208   0.219   0.222   0.203
FADC250_SLOT  17
FADC250_ALLCH_GAIN    0.213   0.218   0.217   0.190   0.219   0.227   0.202   0.206   0.210   0.212   0.227   0.201   0.212   0.215   0.216   0.209
FADC250_SLOT  18
FADC250_ALLCH_GAIN    0.191   0.231   0.194   0.208   0.219   0.211   0.207   0.195   0.191   0.207   0.201   0.199   0.208   0.211   0.217   0.201
FADC250_SLOT  19
FADC250_ALLCH_GAIN    0.191   0.197   0.204   0.208   0.209   0.215   0.211   0.216   0.205   0.248   0.216   0.225   0.238   0.236   0.193   0.197
FADC250_SLOT  20
FADC250_ALLCH_GAIN    0.210   0.213   0.178   0.194   0.196   0.209   0.248   0.210   0.188   0.229   0.242   0.227   0.207   1.000   1.000   1.000

# Set LED system trigger threshold
FADC250_SLOT      20
FADC250_CH_TET    15   500

#       channel:        0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15
FADC250_TET_IGNORE_MASK 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0



FADC250_SLOT  3
FADC250_ALLCH_PED  124.290  58.200  99.110  96.840 115.210 122.610  98.970 131.810 137.890 140.830 135.060 140.170  93.360 129.680 104.950 118.380
FADC250_SLOT  4
FADC250_ALLCH_PED  102.590  96.800  82.780  89.060 116.790  75.860 156.310  65.300 101.460  94.750  60.960 102.440  62.520 130.040  89.700 120.200
FADC250_SLOT  5
FADC250_ALLCH_PED   87.530 143.630  95.820 118.060  96.750 126.190 110.700 131.970  87.420 143.940 112.030 123.600 100.310 113.590  88.070 120.460
FADC250_SLOT  6
FADC250_ALLCH_PED  128.850  99.910 165.400 160.840 155.640 147.700 126.510 105.620 128.330 139.540  83.710 125.770 136.080 112.380 100.510 121.790
FADC250_SLOT  7
FADC250_ALLCH_PED  124.100 139.580 129.930 127.120 125.290 106.800 143.320 146.340 111.530 107.520 124.810 122.280 102.450 113.170 115.090 106.510
FADC250_SLOT  8
FADC250_ALLCH_PED  140.900 133.470  97.660 123.490 126.700 108.010 123.580 117.510 113.130  92.250 136.630 135.810 154.540 114.410 126.090  50.030
FADC250_SLOT  9
FADC250_ALLCH_PED  123.580 138.940 106.770 112.630 127.590 118.820 130.000 137.320 106.680 125.510 120.050  82.700 124.040 102.990  95.100 135.920
FADC250_SLOT  14
FADC250_ALLCH_PED   93.630  99.620 128.550 101.150 114.630 112.630 168.570 140.370 127.820  92.100 122.310 111.870 131.710 121.110 112.010 110.150
FADC250_SLOT  15
FADC250_ALLCH_PED  107.310 148.850 105.270 185.270 142.880 150.100 143.540 149.650 113.680 163.620 103.340 131.970 110.480 129.900 141.720 118.470
FADC250_SLOT  16
FADC250_ALLCH_PED  112.600 144.520 118.110 137.750 157.790  82.850 111.480 110.320  79.700 108.680  86.350 132.150 128.340 106.840 104.380 116.020
FADC250_SLOT  17
FADC250_ALLCH_PED   93.700  93.300 126.570 119.370 140.400  92.850 120.530 120.870 117.720  86.570 133.410  99.390  91.830  96.500  70.230 104.460
FADC250_SLOT  18
FADC250_ALLCH_PED  107.100 123.300 136.840 105.260 135.220 128.280 129.020 117.440  77.990 104.230 101.880 119.700 162.300 141.270 141.830 120.080
FADC250_SLOT  19
FADC250_ALLCH_PED  110.400 129.870 128.590  53.650  91.710 145.150 127.580 134.960 125.350 121.260 141.080 122.710 132.770 106.040 121.250 133.450
FADC250_SLOT  20
FADC250_ALLCH_PED  111.390  92.590 107.760 129.410  82.840 117.430 105.020  87.310 125.390  83.860 103.780  98.680 109.060  78.937  99.759 194.384

FADC250_CRATE end

##########################
# HPS 2 Crate
##########################

### TI
TI_CRATE hps2
TI_FIBER_DELAY_OFFSET 0x80 0xc9
TI_CRATE end

### FADC
FADC250_CRATE hps2

FADC250_SLOT all
FADC250_DAC  3300

FADC250_W_OFFSET 3012
FADC250_W_WIDTH   200

# COSMIC:
#FADC250_W_OFFSET 3180
#FADC250_W_WIDTH   400

FADC250_MODE      1
FADC250_NSB       20
FADC250_NSA       100
FADC250_NPEAK     1

#       channel:        0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15
FADC250_ADC_MASK        1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
FADC250_TRG_MASK        1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
FADC250_TET_IGNORE_MASK 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0

FADC250_TET 12

FADC250_SLOT  3
FADC250_ALLCH_GAIN    0.290   0.224   0.217   0.284   0.246   0.227   0.262   0.220   0.244   0.214   0.220   0.191   0.208   0.214   0.226   0.214
FADC250_SLOT  4
FADC250_ALLCH_GAIN    0.202   0.206   0.232   0.239   0.209   0.234   0.203   0.196   0.202   0.221   0.219   0.240   0.209   0.230   0.210   0.193
FADC250_SLOT  5
FADC250_ALLCH_GAIN    0.208   0.200   0.194   0.203   0.197   0.200   0.208   0.209   0.203   0.218   0.200   0.202   0.199   0.213   0.213   0.190
FADC250_SLOT  6
FADC250_ALLCH_GAIN    0.194   0.182   0.195   0.184   0.188   0.210   0.218   0.237   0.213   0.211   0.203   0.185   0.221   0.206   0.212   0.202
FADC250_SLOT  7
FADC250_ALLCH_GAIN    0.200   0.218   0.214   0.180   0.217   0.201   0.227   0.221   0.221   0.236   0.217   0.209   0.228   0.213   0.207   0.229
FADC250_SLOT  8
FADC250_ALLCH_GAIN    0.201   0.194   0.297   0.202   0.211   0.238   0.189   0.204   0.203   0.223   0.219   0.194   0.211   0.202   0.194   0.209
FADC250_SLOT  9
FADC250_ALLCH_GAIN    0.194   0.200   0.199   0.204   0.221   0.180   0.204   0.217   0.213   0.207   0.186   0.182   0.201   0.205   0.202   0.215
FADC250_SLOT  14
FADC250_ALLCH_GAIN    0.215   0.209   0.196   0.206   0.189   0.209   0.196   0.237   0.208   0.214   0.151   0.211   0.183   0.207   0.223   0.239
FADC250_SLOT  15
FADC250_ALLCH_GAIN    0.212   0.208   0.215   0.207   0.215   0.191   0.191   0.202   0.192   0.220   0.190   0.188   0.212   0.190   0.205   0.198
FADC250_SLOT  16
FADC250_ALLCH_GAIN    0.224   0.219   0.185   0.220   0.215   0.191   0.200   0.222   0.214   0.226   0.229   0.237   0.220   0.225   0.205   0.209
FADC250_SLOT  17
FADC250_ALLCH_GAIN    0.189   0.188   0.186   0.209   0.190   0.190   0.221   0.193   0.212   0.211   0.197   0.204   0.233   0.191   0.193   0.189
FADC250_SLOT  18
FADC250_ALLCH_GAIN    0.204   0.213   0.218   0.212   0.199   0.197   0.219   0.190   0.200   0.220   0.208   0.211   0.210   0.202   0.228   0.268
FADC250_SLOT  19
FADC250_ALLCH_GAIN    0.202   0.251   0.194   0.197   0.243   0.217   0.214   0.208   0.227   0.202   0.204   0.198   0.201   0.219   0.215   0.199
FADC250_SLOT  20
FADC250_ALLCH_GAIN    0.241   0.216   0.219   0.199   0.204   0.206   0.212   0.209   0.213   0.222   0.212   0.221   0.226   1.000   1.000   1.000

# Set cosmic system trigger threshold
# 12bit -> 1V: 40 = ~10mV threshold
# relative to pedestal
FADC250_SLOT      20
FADC250_CH_TET    13   40
FADC250_CH_TET    14   40
#       channel:        0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15
FADC250_TET_IGNORE_MASK 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0





FADC250_SLOT  3
FADC250_ALLCH_PED  138.760 110.360  91.770 132.850 122.590  87.410 158.320 100.530 132.490 139.920 112.640 145.510 137.420 118.260 133.810 154.620
FADC250_SLOT  4
FADC250_ALLCH_PED  137.790 113.630 134.540 116.850 105.610 171.460 161.360 136.520 147.120 123.510 144.100 129.320 148.180 137.470 145.860 121.460
FADC250_SLOT  5
FADC250_ALLCH_PED   97.780  80.550  98.670 124.830 127.980 114.700 110.620 140.630 126.510 129.270  98.470 142.630 125.610 104.980 116.700 119.080
FADC250_SLOT  6
FADC250_ALLCH_PED   94.930 112.950 120.000 110.640 143.980 117.800  88.100  89.130 120.290 163.970 118.370 131.520  92.000 152.870 105.100 124.700
FADC250_SLOT  7
FADC250_ALLCH_PED  177.520 109.790 108.780 126.200 136.860 149.180 131.510 114.000 148.680 133.990 116.970 111.080 118.540 137.530 124.610 145.000
FADC250_SLOT  8
FADC250_ALLCH_PED  114.360 125.650  91.660  99.780 108.470  85.450 121.940 132.670  86.010 151.830 110.920  80.000 105.150  92.630  79.830  94.610
FADC250_SLOT  9
FADC250_ALLCH_PED  122.630 183.020 160.560 154.850 122.830 104.530 114.050 117.390 110.700 173.150 145.220 117.260 134.050 137.240 139.010 164.160
FADC250_SLOT  14
FADC250_ALLCH_PED  151.080 148.990 114.910 102.270 124.510 140.820 124.510 112.190 157.420 149.410 118.480 140.980 105.830 149.270  90.580 127.330
FADC250_SLOT  15
FADC250_ALLCH_PED   97.180 128.760  92.510  87.240 111.590 124.420 118.720 121.550 112.010 113.920 122.430  84.440 102.010 118.840 159.540  78.060
FADC250_SLOT  16
FADC250_ALLCH_PED  107.970 113.050  95.280  93.420 106.120 123.030 107.010 101.710 122.630  98.920 151.130 118.540 115.670 140.070  89.440  98.900
FADC250_SLOT  17
FADC250_ALLCH_PED  115.080 128.900 113.450 105.080 112.210 123.730 114.550 109.950 126.650 116.790 116.310 117.210 115.620 106.830 161.690 119.960
FADC250_SLOT  18
FADC250_ALLCH_PED  141.770 128.810 115.830 142.430 140.950 141.720 142.910 105.650 102.550 110.710 138.980 183.570 140.480 116.590 129.540 156.040
FADC250_SLOT  19
FADC250_ALLCH_PED  117.510 137.120 144.510 101.320  95.860 142.220  89.450  86.640  95.940 119.040 110.560  99.220 128.350 142.390 100.530 144.100
FADC250_SLOT  20
FADC250_ALLCH_PED  113.700 111.890 124.220 113.540  93.180 112.630 113.670  73.850 115.100 115.120  90.070  87.780 127.820 118.765 142.444  93.138



FADC250_CRATE end


# SVT stuff

# include dpm/dpm-default.trg

DPM_CRATE all
DPM_CONFIG_FILE /usr/clas12/release/0.2/slac_svt/svtdaq/daq/config/rce_config.xml
DPM_CRATE end
#include dpm/dpm-3sam-3rms.trg

