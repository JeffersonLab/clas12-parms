##########################
# GTP
##########################
GTP_CRATE all

GTP_CLUSTER_PULSE_COIN      3    3

# SEED thrershold in MeV (0-8191)
GTP_CLUSTER_PULSE_THRESHOLD 50

GTP_CRATE end

##########################
# HPS 11 Crate
##########################

### TI
TI_CRATE hps11

TI_FIBER_DELAY_OFFSET 0x0 0x4f

TI_BUFFER_LEVEL 5
TI_BLOCK_LEVEL  1
#TI_BUFFER_LEVEL 8
#TI_BLOCK_LEVEL  40

# TI trigger RULES: NR triggers, time, timescale
# 1 trigger in 45*480ns=21.6us
#TI_HOLDOFF 1 45 1
#TI_HOLDOFF 1 50 1
# 35kHz, 20% live, ecal only
#TI_HOLDOFF 1 1 1
#TI_HOLDOFF 4 27 1
# 42kHz, 70% live, ecal only
#TI_HOLDOFF 1 1 1
#TI_HOLDOFF 4 1 1
# 36kHz, 21% live time, ecal only
#TI_HOLDOFF 1 21 1
#TI_HOLDOFF 4 27 1
# 1 trigger in 3*480ns=1.44us
TI_HOLDOFF 1 3 1
# 4 triggers in 23*3840ns=88.3us
#TI_HOLDOFF 4 23 1

TI_HOLDOFF 4 8 1


# PRESCALE-FACTOR = 2^N

# SINGLES-0:
TI_INPUT_PRESCALE 1  15

# SINGLES-1:
TI_INPUT_PRESCALE 2  15

# PAIRS-0:
TI_INPUT_PRESCALE 3  15

# PAIRS-1:
TI_INPUT_PRESCALE 4  15

# COSMIC/LED:
TI_INPUT_PRESCALE 5  0

# PULSER:
TI_INPUT_PRESCALE 6  0

TI_CRATE end


### SSP
SSP_CRATE hps11

SSP_ALLSLOTS
SSP_W_WIDTH   50
SSP_W_OFFSET  757

# COSMIC:
#SSP_W_WIDTH   100
#SSP_W_OFFSET  799

SSP_HPS_PULSER 50       # pulser period (s)

# ecal triggers:
# HPS SINGLES 0  -> TI TS1
#SSP_HPS_SET_IO_SRC		7	20	#ENABLED
SSP_HPS_SET_IO_SRC		7	0	#DISABLED

#HPS SINGLES 1   -> TI TS2
#SSP_HPS_SET_IO_SRC		8	21	#ENABLED
SSP_HPS_SET_IO_SRC		8	0	#DISABLED

#HPS PAIRS 0     -> TI TS3
#SSP_HPS_SET_IO_SRC		9	22	#ENABLED
SSP_HPS_SET_IO_SRC		9	0	#DISABLED

#HPS PAIRS 1     -> TI TS4
#SSP_HPS_SET_IO_SRC		10	23	#ENABLED
SSP_HPS_SET_IO_SRC		10	0	#DISABLED

# HPS COSMIC/LED -> TI TS5
#SSP_HPS_SET_IO_SRC		11	24	#ENABLED-LED
#SSP_HPS_SET_IO_SRC		11	25	#ENABLED-COSMIC
SSP_HPS_SET_IO_SRC		11	0	#DISABLED

# PULSER         -> TI TS6
SSP_HPS_SET_IO_SRC		12	18	#ENABLED
#SSP_HPS_SET_IO_SRC		12	0	#DISABLED


# coinc time 10=40 ns
SSP_HPS_COSMIC_TIMECOINCIDENCE  10

# cosmic B0 and B1 (136<<8) + led trigger (254<<0)
SSP_HPS_COSMIC_PATTERNCOINCIDENCE   35070

SSP_HPS_LATENCY 475

# Singles 0 trigger
SSP_HPS_SINGLES_EMIN  0  20   1
SSP_HPS_SINGLES_EMAX  0  8191 1
SSP_HPS_SINGLES_NMIN  0  1    1

# Singles 0 trigger
SSP_HPS_SINGLES_EMIN  1  60   1
SSP_HPS_SINGLES_EMAX  1  3000 1
SSP_HPS_SINGLES_NMIN  1  1    1

# Pairs 0 trigger
SSP_HPS_PAIRS_TIMECOINCIDENCE  0  4
SSP_HPS_PAIRS_EMIN             0  55
SSP_HPS_PAIRS_EMAX             0  1100
SSP_HPS_PAIRS_NMIN             0  1
SSP_HPS_PAIRS_SUMMAX_MIN       0  2000 120 0
SSP_HPS_PAIRS_DIFFMAX          0  1000     0
SSP_HPS_PAIRS_COPLANARITY      0  180      0
SSP_HPS_PAIRS_ENERGYDIST       0  5.5  100 0

# Pairs 1 trigger
SSP_HPS_PAIRS_TIMECOINCIDENCE  1  4
SSP_HPS_PAIRS_EMIN             1  60
SSP_HPS_PAIRS_EMAX             1  650
SSP_HPS_PAIRS_NMIN             1  1
SSP_HPS_PAIRS_SUMMAX_MIN       1  815 150  0
SSP_HPS_PAIRS_DIFFMAX          1  650      0
SSP_HPS_PAIRS_COPLANARITY      1  180      0
SSP_HPS_PAIRS_ENERGYDIST       1  5.5  10  0

SSP_CRATE end


### FADC: RF SIGNALS, HPS11, SLOT 13, CHANNELS 0/1
FADC250_CRATE hps11

FADC250_SLOT all
FADC250_DAC  3300
FADC250_W_OFFSET 3012
FADC250_W_WIDTH 400

FADC250_MODE      1

FADC250_NSB       12
FADC250_NSA       240
FADC250_NPEAK     1

#       channel:  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15
FADC250_ADC_MASK  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
FADC250_TRG_MASK  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1

#Set RF clock threshold
FADC250_TET 6666

FADC250_SLOT 13
FADC250_ALLCH_PED 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0

FADC250_CRATE end


##########################
# HPS 12 Crate
##########################

### TI
TI_CRATE hps12
TI_FIBER_DELAY_OFFSET 0x80 0xc9
TI_CRATE end


##########################
# HPS 1 Crate
##########################

### TI
TI_CRATE hps1
TI_FIBER_DELAY_OFFSET 0x80 0xc9
TI_CRATE end



# ECAL PEDESTALS:

# include trigger/HPS/small/fadc250/peds/EcalPeds.trg


FADC250_CRATE hps1
FADC250_SLOT 3
FADC250_ALLCH_PED   99.078   29.679   71.729   70.367   84.511   93.209   72.278  104.848  110.721  114.486  111.325  110.126   66.282  102.134   76.551   91.771
FADC250_SLOT 4
FADC250_ALLCH_PED   77.350   69.257   54.462   61.225   85.621   50.889  131.844   36.731   75.871   66.619   36.947   73.847   31.794  102.450   61.884   94.898
FADC250_SLOT 5
FADC250_ALLCH_PED   58.705  114.572   66.187   90.308   64.240   96.333   83.882  105.653   59.497  117.167   85.198   91.875   71.475   84.428   60.626   94.185
FADC250_SLOT 6
FADC250_ALLCH_PED  103.703   72.816  138.356  135.026  126.201  119.745  101.096   79.432  100.864  113.040   61.384   95.086  110.986   85.006   74.171   95.654
FADC250_SLOT 7
FADC250_ALLCH_PED   98.065  110.892  101.522   99.655   96.454   96.444  117.728  121.046   85.433   82.021  102.868   92.986   76.374   85.493   88.234   81.123
FADC250_SLOT 8
FADC250_ALLCH_PED  116.323  107.010   70.096   96.585   97.179   80.988   98.482   91.078   87.945   65.910  115.469  105.989  129.993   86.615  100.673   23.082
FADC250_SLOT 9
FADC250_ALLCH_PED   98.276  112.513   80.030   86.301  100.377   91.816  104.349  113.142   80.772   99.629   97.044   54.337   98.901   78.088   70.287  111.921
FADC250_SLOT 14
FADC250_ALLCH_PED   68.224   71.420  101.779   73.732   84.657   84.918  143.021  115.913  101.429   67.026   99.347   82.197  106.088   94.337   84.993   84.205
FADC250_SLOT 15
FADC250_ALLCH_PED   80.915  122.162   78.529  159.717  114.402  123.532  117.505  124.589   87.013  137.481   79.211  104.299   85.284  103.651  116.067   93.565
FADC250_SLOT 16
FADC250_ALLCH_PED   87.088  116.845   90.237  109.550  127.826   56.126   86.463   85.052   50.968   82.099   65.649  102.080  103.577   79.462   78.732   89.899
FADC250_SLOT 17
FADC250_ALLCH_PED   67.287   66.907   97.914   91.272  111.478   66.171   95.811   92.832   91.679   57.037  106.471   69.711   63.405   67.815   41.095   77.158
FADC250_SLOT 18
FADC250_ALLCH_PED   80.480   95.632  109.412   77.167  107.160  100.908  104.130   88.998   50.489   76.446   76.965   89.935  135.227  113.810  115.468   94.071
FADC250_SLOT 19
FADC250_ALLCH_PED   83.846  101.829  101.781   25.756   62.217  116.622  101.443  108.404   96.782   93.679  117.266   92.090  106.184   78.284   92.806  106.833
FADC250_SLOT 20
FADC250_ALLCH_PED   84.299   62.736   77.708   99.619   51.113   87.834   78.165   58.547   97.840   54.996   78.346   67.017   78.562   78.250   98.654  146.020
FADC250_CRATE end
FADC250_CRATE hps2
FADC250_SLOT 3
FADC250_ALLCH_PED  111.787   83.753   63.690  106.279   94.523   59.931  133.835   74.341  106.540  111.708   88.965  116.692  109.776   91.431  106.453  127.257
FADC250_SLOT 4
FADC250_ALLCH_PED  111.848   86.834  106.819   90.982   76.779  144.438  135.738  112.100  122.283   97.696  121.843  100.714  123.341  111.115  121.309   95.691
FADC250_SLOT 5
FADC250_ALLCH_PED   71.854   50.487   72.332   98.624   99.888   84.200   81.852  118.638   97.382  102.566   73.983  113.708  101.680   78.055   90.949   92.102
FADC250_SLOT 6
FADC250_ALLCH_PED   68.450   81.967   93.848   84.247  114.774   88.308   61.862   66.335   90.855  137.334   93.824  104.360   70.759  127.150   77.843   96.745
FADC250_SLOT 7
FADC250_ALLCH_PED  152.280   81.525   83.845  101.003  106.896  119.868  103.665   90.990  122.153  107.537   96.051   84.853   96.365  111.883   99.828  118.412
FADC250_SLOT 8
FADC250_ALLCH_PED   88.925   97.968   62.186   72.400   76.121   56.601   95.828  109.428   57.960  127.989   85.540   52.418   79.465   65.014   54.166   66.897
FADC250_SLOT 9
FADC250_ALLCH_PED   96.683  156.755  134.155  130.519   94.056   78.025   87.499   92.817   83.848  147.950  123.493   88.668  109.771  111.378  114.676  139.809
FADC250_SLOT 14
FADC250_ALLCH_PED  126.776  122.562   88.130   75.999   95.977  113.838  100.936   87.767  132.486  124.930   97.711  112.809   81.382  123.812   65.341  102.009
FADC250_SLOT 15
FADC250_ALLCH_PED   71.694  104.703   65.812   61.253   82.860   97.868   95.191   94.794   85.889   88.649   96.623   56.546   75.137   91.718  134.042   52.157
FADC250_SLOT 16
FADC250_ALLCH_PED   82.272   83.931   66.786   65.582   75.268   95.143   80.319   75.949   96.141   72.518  129.191   89.606   91.578  114.343   63.666   71.632
FADC250_SLOT 17
FADC250_ALLCH_PED   89.342  101.979   85.643   77.688   84.118   96.538   89.867   84.094  100.495   90.252   91.143   86.849   87.478   80.056  135.221   93.771
FADC250_SLOT 18
FADC250_ALLCH_PED  115.457  101.737   88.892  117.343  113.452  114.436  117.272   78.408   76.032   82.992  115.974  155.081  114.076   90.427  103.380  130.719
FADC250_SLOT 19
FADC250_ALLCH_PED   91.022  108.500  118.313   74.530   65.683  113.841   61.820   62.757   67.910   92.563   86.969   70.276  104.008  116.069   74.776  115.879
FADC250_SLOT 20
FADC250_ALLCH_PED   88.309   84.502   95.853   86.453   64.063   84.077   87.508   46.050   88.346   87.675   65.425   58.331  100.506  117.971  141.626   93.525
FADC250_CRATE end

# include trigger/HPS/small/fadc250/peds/CalibPeds.trg

FADC250_CRATE hps1
FADC250_SLOT 20
FADC250_CH_PED 13  78.937
FADC250_CH_PED 14  99.759
FADC250_CH_PED 15 194.484
FADC250_CRATE end
FADC250_CRATE hps2
FADC250_SLOT 20
FADC250_CH_PED 13 118.765
FADC250_CH_PED 14 142.444
FADC250_CH_PED 15  93.138
FADC250_CRATE end


### FADC
FADC250_CRATE hps1

FADC250_SLOT all
FADC250_DAC  3300

FADC250_W_OFFSET 3012
FADC250_W_WIDTH   200

# COSMIC:
#FADC250_W_OFFSET 3180
#FADC250_W_WIDTH   400

FADC250_MODE      1
FADC250_NSB       20
FADC250_NSA       100
FADC250_NPEAK     1

#       channel:        0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15
FADC250_ADC_MASK        1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
FADC250_TRG_MASK        1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
FADC250_TET_IGNORE_MASK 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0

FADC250_TET 6

FADC250_SLOT  3
FADC250_ALLCH_GAIN    1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 
FADC250_SLOT  4
FADC250_ALLCH_GAIN    1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000
FADC250_SLOT  6
FADC250_ALLCH_GAIN    1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000
FADC250_SLOT  7
FADC250_ALLCH_GAIN    1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000
FADC250_SLOT  8
FADC250_ALLCH_GAIN    1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000
FADC250_SLOT  9
FADC250_ALLCH_GAIN    1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000
FADC250_SLOT  14
FADC250_ALLCH_GAIN    1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000
FADC250_SLOT  15
FADC250_ALLCH_GAIN    1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000
FADC250_SLOT  16
FADC250_ALLCH_GAIN    1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000
FADC250_SLOT  17
FADC250_ALLCH_GAIN    1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000
FADC250_SLOT  18
FADC250_ALLCH_GAIN    1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000
FADC250_SLOT  19
FADC250_ALLCH_GAIN    1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000
FADC250_SLOT  20
FADC250_ALLCH_GAIN    1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000

# Set LED system trigger threshold
FADC250_SLOT      20
FADC250_CH_TET    15   500

FADC250_CRATE end

##########################
# HPS 2 Crate
##########################

### TI
TI_CRATE hps2
TI_FIBER_DELAY_OFFSET 0x80 0xc9
TI_CRATE end

### FADC
FADC250_CRATE hps2

FADC250_SLOT all
FADC250_DAC  3300

FADC250_W_OFFSET 3012
FADC250_W_WIDTH   200

# COSMIC:
#FADC250_W_OFFSET 3180
#FADC250_W_WIDTH   400

FADC250_MODE      1
FADC250_NSB       20
FADC250_NSA       100
FADC250_NPEAK     1

#       channel:        0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15
FADC250_ADC_MASK        1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
FADC250_TRG_MASK        1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
FADC250_TET_IGNORE_MASK 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0

# set to zero to read out ALL channels to maximize data rate:
#FADC250_TET 0

# set to high value to minimize data rate:
FADC250_TET 6

FADC250_SLOT  3
FADC250_ALLCH_GAIN    1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000
FADC250_SLOT  4
FADC250_ALLCH_GAIN    1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000
FADC250_SLOT  6
FADC250_ALLCH_GAIN    1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000
FADC250_SLOT  7
FADC250_ALLCH_GAIN    1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000
FADC250_SLOT  8
FADC250_ALLCH_GAIN    1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000
FADC250_SLOT  9
FADC250_ALLCH_GAIN    1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000
FADC250_SLOT  14
FADC250_ALLCH_GAIN    1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000
FADC250_SLOT  15
FADC250_ALLCH_GAIN    1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000
FADC250_SLOT  16
FADC250_ALLCH_GAIN    1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000
FADC250_SLOT  17
FADC250_ALLCH_GAIN    1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000
FADC250_SLOT  18
FADC250_ALLCH_GAIN    1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000
FADC250_SLOT  19
FADC250_ALLCH_GAIN    1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000
FADC250_SLOT  20
FADC250_ALLCH_GAIN    1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000

FADC250_CRATE end
#

# SVT stuff

# include dpm/dpm-default.trg

DPM_CRATE all
DPM_CONFIG_FILE /usr/clas12/release/0.3/slac_svt/svtdaq/daq/config/rce_config.xml
DPM_CRATE end
#include dpm/dpm-3sam-3rms.trg

